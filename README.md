# Static Face Recognition using Haar feature based Cascade Classifier with Linear SVM

## A. Installation of Anaconda

For this project, You need 'Anaconda' for running this project. You have to go to the following link:

https://www.anaconda.com/products/individual

After going to this link, you can then click on 'Download' and then install it. 

## B. Creation & Activation of Environment

After this, You have to give following command to create your new environment. You can choose any name other than 'facerecognition'

	conda create --name facerecognition python=3.6
	
Activate the environment by using the following command:

	conda activate facerecognition


## C. Install the following dependecies one by one

	pip install opencv-python
	pip install numpy
	pip install opencv-contrib-python
	pip install pandas
	pip install scikit-learn
	pip install matplotlib
	
## D. Cloning the face_recognition repository
For clonning the reporistory, you have to write following command:

	git clone https://github.com/Rimpy671/face_recognition.git

## E. The details of the files and folders are given below: 

## 1. __pycache__ 
It is a directory that contains bytecode cache files that are automatically generated by
python, namely compiled python, or . pyc , files.

## 2. csvFiles
In this folder, you will see the csv files such as Train.csv, Unknown.csv and Test.csv
###### 2.1 Train.csv
This file is generated after creating feature vector of training images 
###### 2.2 Test.csv
This file is generated after creating feature vector of test images
###### 2.3 Unknown.csv
This file has features data of one image only and generated on the runtime main file

## 3. Dataset
It includes the dataset used in this project for training the face recognition model. It has further two subfolders

###### 3.1 Train
This folder includes further 10 folders in which each folder has in range 17-22 images of each person chosen
from the face database of Caltech Institute. Selective images are used and placed in the folder manually. 
This Train folder is being used by the SVM_Model_Training.py for training the SVM model

###### 3.2 Test
This folder also includes further 10 folders in which each folder has 3-5 images of each person chosen from the face database of Caltech Institue. This Test folder is being used by the SVM_Model_Training.py for checking the model with Unseen Test images

## 4. faces
Original dataset downloaded from the Caltech Institute website. This dataset can be downloaded by clicking on the link below: 

http://www.vision.caltech.edu/html-files/archive.html

Visit this website and under the 'Caltech categories', you will find 'Faces 1999(front)'. Click on 'Tar files of images' and then the zip folder will be installed. This folder is used to get more pictures in the future according to the requirement. 

## 5. haar_cascade
This folder contains the trained Haar cascade classifier for frontal face detection. This is being used for detecting the face and then cropping it for training and testing purposes. 

## 6. models
This folder contains the trained SVM models. Currently  'Trained' model is being used. You can train a new model by running the file 'SVM_Model_Training.py'

## 7.  Runtime_Input
This folder contains images that will be used for the for the main.py file. Whenever you want to test any image, then you can place them in this folder. 
Run the main.py and input the image file name without extention. It will store the output file with label and face detection in Runtime_Output folder

## 8. Runtime_Output
This folder contains the output images that will processed after running the main.py file. The output image file will have detected face and label on it
with confidence percentage

## 9. Creating_CSV.py

###### 1.
This is a Feature vector creation file from the given training and test dataset. On running this file, it will ask you about the resolution of the image. 
Normally, for this project 30x30 resolution is recommended. You can change the resolution according to you but make sure that then both Train and 
Test images along with the images on the runtime main file will be treated in new resolution. For 30x30, please type 30


###### 2.
It will then ask that which dataset you want to train. Type exactly "Test" or "Train" because it is case-sensitive. 

###### 3.
It allows you to train number of images according to you so you can select from 2 to 10 persons categories folder according to your requirement. 

###### 4.
You can also set the random seed that will randomly select the persons folder. 

###### 5.
After this, the generated file will be saved in the 'csvFiles' folder. You can see that e.g if you typed 'Train' then it will be saved with 'Train.csv' filename

## 10. csvLibrary.py
	
This is a library file that generated .csv file by taking Feature Vector array and .csv file name as the parameters of its function

## 11. ExtractFaceFeatures.py
	
This is a library file that is used to detect the face and convert it into feature vector after preprocessing it. 

## 12. FeatureVector.py
	
It is essential library file which is used to generate the dataset. The details of functions are given below: 

###### 1. countTotal(classes, path) 
This function take person categories and path to the image dataset and returns the total number of files
###### 2. DataMatrixGeneration(CATEGORIES, DATADIR, IMG_SIZE)
This function takes image categories, path and resolution and returns the feature 	    vector matrix without any header
###### 3. HeaderGeneration(Vector_Size) 
This functions takes ResolutionxResolution for generating the single row vector Header 
###### 4. DataMatrixPreparation(CATEGORIES, DATADIR, IMG_SIZE, shuffle)
This function prepares the final feature vector by appending the header and shuffles the feature vector. 

## 13. FeatureVectorCSV.py
	
It uses function generateFeatureVectorCSV(CATEGORIES, DATADIR, IMG_SIZE, ENABLE_RANDOM, CSV_FILE_NAME)
that generate .csv file from the Data Matrix

## 14. SVM_Model_Training.py
	
This is an important file that is used for the training the model. 

###### 1. 
It first ask you that do you want to train the model or not. If you say "Yes" then it ask the model name and then it will start training the model
It uses the SVM Linear model with default parameters set by Sckit-Learn library. 

###### 2.
Secondly, It will ask you that do you want to apply the trained model. If you say "Yes" then it will apply the trained model on the test dataset
and then will show you results. After this, you will be asked if you would like to see their probabilites or not. 


## 15. main.py
	
In this file, you are allowed to input any image that is contained in the Runtime_Input folder. It will first predict the person by 
preprocessing it and then pass from the trained model. The resultant image with detected face and name with percentage confidence 
score will be shown on the screen in the separate window. By closing the separate image frame window, the output file will be saved 
in the Runtime_Output.py folder. 

	




